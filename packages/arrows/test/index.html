<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8' />
    <title>Annotorious | Arrows Plugin</title>
  </head>

  <body>
    <div id="content">
      <div>
        <button id="tool">Annotate</button>
        <button id="arrow-mode" disabled>Select</button>
      </div>
      <img id="sample-image" src="640px-Hallstatt.jpg" />
    </div>
    
    <script type="module">
      import { createImageAnnotator } from '@annotorious/annotorious';
      import { mountImagePlugin } from '../src';

      import '@annotorious/annotorious/annotorious.css';

      window.onload = function() {    
        const anno = createImageAnnotator('sample-image');
        const arrowsPlugin = mountImagePlugin(anno);

        anno.loadAnnotations('annotations.json');

        const arrowModeBtn = document.getElementById('arrow-mode');
        arrowModeBtn.addEventListener('click', () => {
          if (arrowModeBtn.innerText === 'Draw') {
            arrowModeBtn.innerText = 'Select';
            arrowsPlugin.setMode('select');
          } else {
            arrowModeBtn.innerText = 'Draw';
            arrowsPlugin.setMode('draw');
          }
        });

        anno.on('createAnnotation', a => {
          console.log('created', a);
          
          if (a.motivation === 'pointing') {
            arrowsPlugin.setMode('select');
            arrowModeBtn.innerText = 'Select';
          }
        });

        anno.on('updateAnnotation', a => console.log('updated', a));
        anno.on('selectionChanged', s => console.log('selected', s));

        const toolBtn = document.getElementById('tool');
        toolBtn.addEventListener('click', () => {
          if (toolBtn.innerText === 'Annotate') {
            toolBtn.innerText = 'Arrows';
            arrowModeBtn.disabled = false;
          } else {
            toolBtn.innerText = 'Annotate';
            arrowModeBtn.disabled = true;
          }
        });
      }
    </script>
  </body>
</html>